setwd("~/Dropbox/DBA3702 Descriptive Analytics with R/Lecture Notes/6 - Exploring Data")
stats <- read.csv("Data\\General Stats.csv")
stats <- read.csv("Data/General Stats.csv")
setwd("~/Dropbox/DBA3702 Descriptive Analytics with R/Lecture Notes/6 - Exploring Data")
stats <- read.csv("Data/General Stats.csv")
data <- read.csv("Data/Levis' Data.csv")
product <- read.csv("Data/Product.csv")
sales <- read.csv("Data/Sales Data.csv")
options(digits = 2)
pert <- function(len, var = 0.05)
{
per <- rnorm(len,0,var)
return(per - mean(per))
}
OnlineFraction <- function(region,year)
{
Region <- c("America","Europe", "Asia", "other")
Fra <- c(0.31, 0.27, 0.17, 0.12)* rnorm(1,1,0.15) + (year - 2005)/100
return(Fra[which(region == Region)])
}
### Tops and Bottoms, Online and B&M Stores, Women's Clothing Share
### Tops, bottoms, online stores revenue, Brick and Mortar stores revenue, men's clothing share, women's clothing share
True.data <- read.csv("levis.csv", header = TRUE, stringsAsFactors = FALSE)
True.data
name.of.data <- c("Tops.men", "Bottoms.men","Tops.women","Bottoms.women", "Online","B&M stores","Men's market share", "women's market share")
men <- (True.data$Net.Revenue.Americas. + True.data$Net.Revenue.Europe. + True.data$Net.Revenue.Asia.Pacific.) * rnorm(NROW(True.data),0.7,0.02)
women <- (True.data$Net.Revenue.Americas. + True.data$Net.Revenue.Europe. + True.data$Net.Revenue.Asia.Pacific.) - men
men.top <- men * rnorm(length(men),0.3,0.02)
women.top <- women * rnorm(length(women),0.3,0.02)
men.bottom <- men - men.top
women.bottom <- women - women.top
online <- (True.data$Net.Revenue.Americas. + True.data$Net.Revenue.Europe. + True.data$Net.Revenue.Asia.Pacific.) * rnorm(NROW(True.data),0.2,0.02)
B.M.Store <- (True.data$Net.Revenue.Americas. + True.data$Net.Revenue.Europe. + True.data$Net.Revenue.Asia.Pacific.) - online
men.market.share <- rnorm(NROW(True.data),3.64,0.05) * 0.85
women.market.share <- rnorm(NROW(True.data),3.64,0.05) * 0.15
Levi.data <- data.frame(Tops.men = men.top, Tops.women = women.top,
Bottoms.men = men.bottom, Bottoms.women = women.bottom,
Online = online, B.M.Store = B.M.Store,
Men.market.share.percent = men.market.share, Women.market.share.percent = women.market.share)
Data = cbind(True.data,Levi.data)
Data = round(Data, digits = 1)
write.csv(Data, "Levis' Data.csv")
### Five Charts needed
### Sales Data by Country and product
### Debt by Year
### Ad Cost by Country and Qrt. and Year
### Product detail
### Cost by year
##### Countries selected: United States, Britain, France, Germany, Spain, Italy, China, Indian
##### Time periods: 2006,2007,2008,2009,2010
##### Qrt 1, Qrt 2, Qrt 3, Qrt 4
##### Region: America, Europe, Asia
Country <- c("United States","Canada", "Britain", "France", "Germany", "Spain", "Italy", "China", "Indian","Other")
Country.share <- matrix(c(0.34,0.33,0.35,0.34,0.33,0.22,0.23,0.21,0.24,0.22,0.07,0.06,0.06,0.05,0.05,0.06,0.05,0.06,0.05,0.05,0.05,0.06,0.05,0.04,0.04,0.04,0.03,0.03,0.04,0.03,0.03,0.04,0.04,0.02,0.02,0.08,0.09,0.09,0.10,0.12,0.05,0.04,0.05,0.06,0.07,0.06,0.07,0.06,0.06,0.07),5)
Country.share[,3] = Country.share[,3] + 0.02
Country.share[,4] = Country.share[,4] + 0.02
Country.share[,8] = Country.share[,8] - 0.02
Country.share[,9] = Country.share[,9] - 0.01
Country.share[,8] <- c(0.08,0.08,0.07,0.08,0.09)
Country.share[,9] <- c(0.06,0.04,0.04,0.05,0.07)
Country.region <- c(rep("America",2),rep("Europe",5),rep("Asia",2),"other")
Sales <- data.frame()
Debt <- data.frame()
Ad <- data.frame()
Product <- data.frame()
Data <- read.csv("Levis' Data.csv", header = TRUE, stringsAsFactors = FALSE)
### Advertisement
Adver <- Data$Advertising.And.Promotion.Expense
Adver.USA <- Adver * c(0.34,0.33,0.35,0.34,0.33)
Adver.Canada <- Adver * c(0.22,0.23,0.21,0.24,0.22)
Adver.Britain <- Adver * c(0.07,0.06,0.06,0.05,0.05) + 0.02
Adver.France <- Adver * c(0.06,0.05,0.06,0.05,0.05) + 0.01
Adver.Germany <- Adver * c(0.05,0.06,0.05,0.04,0.04)
Adver.Spain <- Adver * c(0.04,0.03,0.03,0.04,0.03)
Adver.Italy <- Adver * c(0.03,0.04,0.04,0.02,0.02)
Adver.China <- Adver * c(0.08,0.09,0.09,0.10,0.12)-0.02
Adver.Indian <- Adver * c(0.05,0.04,0.05,0.06,0.07)-0.01
Adver.Other <- Adver * c(0.06,0.07,0.06,0.06,0.07)
Ad <- data.frame(Year = 2006:2010,USA = Adver.USA, Canada = Adver.Canada, Britain = Adver.Britain, France = Adver.France, Germany = Adver.Germany,
Spain = Adver.Spain, Italy = Adver.Italy, China = Adver.China, Indian = Adver.Indian, Other = Adver.Other)
Ad.temp = NULL
for(i in 1:5)
{
div <- c(24,27,30)* rnorm(1, 1, 0.05)
div <- c(div, 100 - sum(div))/100
ad.tmp <- NULL
for(j in 1:4)
{
ad.tmp <- rbind(ad.tmp, round(Ad[i, c(-1)] * div[j],2))
}
Qrt <- paste(" Qrt", 1:4, sep = "")
Year = rep(Ad[i,1],4)
Ad.temp <- rbind(Ad.temp, cbind(Year, Qrt, ad.tmp))
}
Ad <- Ad.temp
Ad
### Product List
### ID, Name, Price, Category
ID <- c("L501R","J511T","F541T", "505T","NBA01R", "RC03R", "NFL03T", "W711R", "W721T","S701T","U702R","J230V", "P532R")
Name <- c("1944 Jeans", "Slim Fit Stretch Jeans","Athletic Fit Stretch Jeans", "1967 Jeans","NBA Denim Trucker Jacket"
,"Reversible Souvenir Coach's Jacket","NFL Denim Trucker Jacket","Utility Skinny Ankle Jeans"
,"High Rise Skinny Selvedge Jeans","1950 Jeans","Ultimate Western Shirt","J.V. Tee Shirt", "Perfect Pocket Tee shirt")
Price <- c(285, 46.98, 48.98, 199.98,79.98,69.98, 69.98,54.50,128,194.98,54.50, 34.50, 29.50)
Category <- c("Men.Bottom","Men.Bottom", "Men.Bottom", "Men.Bottom", "Men.Top","Men.Top","Men.Top"
,"Women.Bottom","Women.Bottom","Women.Bottom","Women.Top","Women.Top","Women.Top")
Product <- data.frame(ID = ID, Name = Name, Avg.Price = Price, Category = Category)
Product.share <- c(0.26987725,0.11657615,0.07946139,0.02408521,0.10106545,0.08751410,0.02142046
,0.12073741,0.04848172,0.04078087,0.062570982,0.018690751,0.008738267)
Prod.s <- function(share,increase,decrease)
{
share[increase] = share[increase]*(1 + runif(length(increase),0.08,0.2))
share[decrease] = share[decrease]*(1 - runif(length(decrease),0.08,0.2))
prod = share/sum(share)
return(prod)
}
#Product.share
#Prod.s(Product.share,c(1,2,3),c(4,5,6))
country.re <- data.frame()
country.ex <- data.frame()
for (country in Country) {
country.re <- rbind(country.re,sort(sample(4:13,5)))
country.ex <- rbind(country.ex,sort(sample(4:13,6)))
}
row.names(country.re) <- Country
row.names(country.ex) <- Country
# Qrt share
### Sales Data by Country and Product
Product.rev.sha = data.frame(Product.share)
Product.exp.sha = data.frame(Product.share)
for (i in 1:(length(Country)-1)) {
Product.rev.sha = data.frame(Product.rev.sha ,Product.share)
Product.exp.sha = data.frame(Product.rev.sha ,Product.share)
}
names(Product.rev.sha) <- Country
names(Product.exp.sha) <- Country
Product.rev.share$China
for(year in Data$FY){
Sale.data <- data.frame()
dat <- Data[which(Data$FY == year),]
rev.total <- dat$Net.Revenue.Americas. + dat$Net.Revenue.Europe. + dat$Net.Revenue.Asia.Pacific.
#adprom <- dat$Advertising.And.Promotion.Expense
expense.total <- dat$Total.Cost.of.Goods.Sold
country.share <- Country.share[which(Data$FY == year),]
for(country in Country){
rev.country <- rev.total * country.share[which(Country == country)]
#adprom.country <- adprom * Country.share[which(Country == country)]
expense.country <- expense.total * country.share[which(Country == country)]
Product.rev.sha[,which(country == Country)] <- Prod.s(Product.rev.sha[,which(country == Country)],c(2,as.numeric(country.re[country,])),c(1,3,(4:13)[!((4:13) %in% as.numeric(country.re[country,]))]))
Product.exp.sha[,which(country == Country)] <- Prod.s(Product.exp.sha[,which(country == Country)],c(2,3,as.numeric(country.ex[country,])),c(1,(4:13)[!((4:13) %in% as.numeric(country.ex[country,]))]))
Product.rev.share = Product.rev.sha[,which(country == Country)]
Product.exp.share = Product.exp.sha[,which(country == Country)]
for (product in Product$ID) {
rev.product <- rev.country * Product.rev.share[which(product == Product$ID)]
exp.product <- expense.country * Product.exp.share[which(product == Product$ID)]
for (qrt in c("Qrt 1", "Qrt 2", "Qrt 3", "Qrt 4")) {
qrt.share = sample(22:28,4) * rnorm(4,1,0.1)
qrt.share <- qrt.share/sum(qrt.share)
rev.prod.qrt <- rev.product * qrt.share[which(qrt == c("Qrt 1", "Qrt 2", "Qrt 3", "Qrt 4"))]
qrt.share = sample(22:28,4) * rnorm(4,1,0.1)
qrt.share <- qrt.share/sum(qrt.share)
exp.prod.qrt <- exp.product * qrt.share[which(qrt == c("Qrt 1", "Qrt 2", "Qrt 3", "Qrt 4"))]
Region = Country.region[which(Country == country)]
data.country.prod <- data.frame(Country = country, Region = Region,
Year = year, Qrt = qrt, Product = product, Revenue = round(rev.prod.qrt,2), Expense = round(exp.prod.qrt,2),Sales.From.Online.Store = round(OnlineFraction(Region,year),2))
Sale.data <- rbind(Sale.data, data.country.prod)
}
}
}
Sales <- rbind(Sales,Sale.data)
}
Online <- NULL
for(year in Data$FY)
{
Online = c(Online, sum(Sales[which(Sales$Year == year),6] * Sales[which(Sales$Year == year),8]))
}
Data$B.M.Store = Data$B.M.Store + Data$Online - Online
Data$Online = Online
write.csv(Data,"Levis' Data.csv")
### General Stats, Debt, Expense
GStats <- Data[,c(2,6,7,8,9,10,11,12,20,21,26,27)]
GStats
write.csv(GStats,"General Stats.csv")
write.csv(Sales, "Sales Data.csv")
Product <- Product[sample(1:NROW(Product)),]
row.names(Product) <- 1:13
Product
write.csv(Product,"Product.csv")
write.csv(Ad,"Advertisement and Promotion.csv")
y2006 <- Sales[which(Sales$Year == 2006),]
sum(y2006$Revenue)
setwd("~/Dropbox/DBA3702 Descriptive Analytics with R/Lecture Notes/6 - Exploring Data/Data")
options(digits = 2)
pert <- function(len, var = 0.05)
{
per <- rnorm(len,0,var)
return(per - mean(per))
}
OnlineFraction <- function(region,year)
{
Region <- c("America","Europe", "Asia", "other")
Fra <- c(0.31, 0.27, 0.17, 0.12)* rnorm(1,1,0.15) + (year - 2005)/100
return(Fra[which(region == Region)])
}
### Tops and Bottoms, Online and B&M Stores, Women's Clothing Share
### Tops, bottoms, online stores revenue, Brick and Mortar stores revenue, men's clothing share, women's clothing share
True.data <- read.csv("levis.csv", header = TRUE, stringsAsFactors = FALSE)
True.data
name.of.data <- c("Tops.men", "Bottoms.men","Tops.women","Bottoms.women", "Online","B&M stores","Men's market share", "women's market share")
men <- (True.data$Net.Revenue.Americas. + True.data$Net.Revenue.Europe. + True.data$Net.Revenue.Asia.Pacific.) * rnorm(NROW(True.data),0.7,0.02)
women <- (True.data$Net.Revenue.Americas. + True.data$Net.Revenue.Europe. + True.data$Net.Revenue.Asia.Pacific.) - men
men.top <- men * rnorm(length(men),0.3,0.02)
women.top <- women * rnorm(length(women),0.3,0.02)
men.bottom <- men - men.top
women.bottom <- women - women.top
online <- (True.data$Net.Revenue.Americas. + True.data$Net.Revenue.Europe. + True.data$Net.Revenue.Asia.Pacific.) * rnorm(NROW(True.data),0.2,0.02)
B.M.Store <- (True.data$Net.Revenue.Americas. + True.data$Net.Revenue.Europe. + True.data$Net.Revenue.Asia.Pacific.) - online
men.market.share <- rnorm(NROW(True.data),3.64,0.05) * 0.85
women.market.share <- rnorm(NROW(True.data),3.64,0.05) * 0.15
Levi.data <- data.frame(Tops.men = men.top, Tops.women = women.top,
Bottoms.men = men.bottom, Bottoms.women = women.bottom,
Online = online, B.M.Store = B.M.Store,
Men.market.share.percent = men.market.share, Women.market.share.percent = women.market.share)
Data = cbind(True.data,Levi.data)
Data = round(Data, digits = 1)
write.csv(Data, "Levis' Data.csv")
### Five Charts needed
### Sales Data by Country and product
### Debt by Year
### Ad Cost by Country and Qrt. and Year
### Product detail
### Cost by year
##### Countries selected: United States, Britain, France, Germany, Spain, Italy, China, Indian
##### Time periods: 2006,2007,2008,2009,2010
##### Qrt 1, Qrt 2, Qrt 3, Qrt 4
##### Region: America, Europe, Asia
Country <- c("United States","Canada", "Britain", "France", "Germany", "Spain", "Italy", "China", "Indian","Other")
Country.share <- matrix(c(0.34,0.33,0.35,0.34,0.33,0.22,0.23,0.21,0.24,0.22,0.07,0.06,0.06,0.05,0.05,0.06,0.05,0.06,0.05,0.05,0.05,0.06,0.05,0.04,0.04,0.04,0.03,0.03,0.04,0.03,0.03,0.04,0.04,0.02,0.02,0.08,0.09,0.09,0.10,0.12,0.05,0.04,0.05,0.06,0.07,0.06,0.07,0.06,0.06,0.07),5)
Country.share[,3] = Country.share[,3] + 0.02
Country.share[,4] = Country.share[,4] + 0.02
Country.share[,8] = Country.share[,8] - 0.02
Country.share[,9] = Country.share[,9] - 0.01
Country.share[,8] <- c(0.08,0.08,0.07,0.08,0.09)
Country.share[,9] <- c(0.06,0.04,0.04,0.05,0.07)
Country.region <- c(rep("America",2),rep("Europe",5),rep("Asia",2),"other")
Sales <- data.frame()
Debt <- data.frame()
Ad <- data.frame()
Product <- data.frame()
Data <- read.csv("Levis' Data.csv", header = TRUE, stringsAsFactors = FALSE)
### Advertisement
Adver <- Data$Advertising.And.Promotion.Expense
Adver.USA <- Adver * c(0.34,0.33,0.35,0.34,0.33)
Adver.Canada <- Adver * c(0.22,0.23,0.21,0.24,0.22)
Adver.Britain <- Adver * c(0.07,0.06,0.06,0.05,0.05) + 0.02
Adver.France <- Adver * c(0.06,0.05,0.06,0.05,0.05) + 0.01
Adver.Germany <- Adver * c(0.05,0.06,0.05,0.04,0.04)
Adver.Spain <- Adver * c(0.04,0.03,0.03,0.04,0.03)
Adver.Italy <- Adver * c(0.03,0.04,0.04,0.02,0.02)
Adver.China <- Adver * c(0.08,0.09,0.09,0.10,0.12)-0.02
Adver.Indian <- Adver * c(0.05,0.04,0.05,0.06,0.07)-0.01
Adver.Other <- Adver * c(0.06,0.07,0.06,0.06,0.07)
Ad <- data.frame(Year = 2006:2010,USA = Adver.USA, Canada = Adver.Canada, Britain = Adver.Britain, France = Adver.France, Germany = Adver.Germany,
Spain = Adver.Spain, Italy = Adver.Italy, China = Adver.China, Indian = Adver.Indian, Other = Adver.Other)
Ad.temp = NULL
for(i in 1:5)
{
div <- c(24,27,30)* rnorm(1, 1, 0.05)
div <- c(div, 100 - sum(div))/100
ad.tmp <- NULL
for(j in 1:4)
{
ad.tmp <- rbind(ad.tmp, round(Ad[i, c(-1)] * div[j],2))
}
Qrt <- paste(" Qrt", 1:4, sep = "")
Year = rep(Ad[i,1],4)
Ad.temp <- rbind(Ad.temp, cbind(Year, Qrt, ad.tmp))
}
Ad <- Ad.temp
Ad
### Product List
### ID, Name, Price, Category
ID <- c("L501R","J511T","F541T", "505T","NBA01R", "RC03R", "NFL03T", "W711R", "W721T","S701T","U702R","J230V", "P532R")
Name <- c("1944 Jeans", "Slim Fit Stretch Jeans","Athletic Fit Stretch Jeans", "1967 Jeans","NBA Denim Trucker Jacket"
,"Reversible Souvenir Coach's Jacket","NFL Denim Trucker Jacket","Utility Skinny Ankle Jeans"
,"High Rise Skinny Selvedge Jeans","1950 Jeans","Ultimate Western Shirt","J.V. Tee Shirt", "Perfect Pocket Tee shirt")
Price <- c(285, 46.98, 48.98, 199.98,79.98,69.98, 69.98,54.50,128,194.98,54.50, 34.50, 29.50)
Category <- c("Men.Bottom","Men.Bottom", "Men.Bottom", "Men.Bottom", "Men.Top","Men.Top","Men.Top"
,"Women.Bottom","Women.Bottom","Women.Bottom","Women.Top","Women.Top","Women.Top")
Product <- data.frame(ID = ID, Name = Name, Avg.Price = Price, Category = Category)
Product.share <- c(0.26987725,0.11657615,0.07946139,0.02408521,0.10106545,0.08751410,0.02142046
,0.12073741,0.04848172,0.04078087,0.062570982,0.018690751,0.008738267)
Prod.s <- function(share,increase,decrease)
{
share[increase] = share[increase]*(1 + runif(length(increase),0.08,0.2))
share[decrease] = share[decrease]*(1 - runif(length(decrease),0.08,0.2))
prod = share/sum(share)
return(prod)
}
#Product.share
#Prod.s(Product.share,c(1,2,3),c(4,5,6))
country.re <- data.frame()
country.ex <- data.frame()
for (country in Country) {
country.re <- rbind(country.re,sort(sample(4:13,5)))
country.ex <- rbind(country.ex,sort(sample(4:13,6)))
}
row.names(country.re) <- Country
row.names(country.ex) <- Country
# Qrt share
### Sales Data by Country and Product
Product.rev.sha = data.frame(Product.share)
Product.exp.sha = data.frame(Product.share)
for (i in 1:(length(Country)-1)) {
Product.rev.sha = data.frame(Product.rev.sha ,Product.share)
Product.exp.sha = data.frame(Product.rev.sha ,Product.share)
}
names(Product.rev.sha) <- Country
names(Product.exp.sha) <- Country
Product.rev.share$China
for(year in Data$FY){
Sale.data <- data.frame()
dat <- Data[which(Data$FY == year),]
rev.total <- dat$Net.Revenue.Americas. + dat$Net.Revenue.Europe. + dat$Net.Revenue.Asia.Pacific.
#adprom <- dat$Advertising.And.Promotion.Expense
expense.total <- dat$Total.Cost.of.Goods.Sold
country.share <- Country.share[which(Data$FY == year),]
for(country in Country){
rev.country <- rev.total * country.share[which(Country == country)]
#adprom.country <- adprom * Country.share[which(Country == country)]
expense.country <- expense.total * country.share[which(Country == country)]
Product.rev.sha[,which(country == Country)] <- Prod.s(Product.rev.sha[,which(country == Country)],c(2,as.numeric(country.re[country,])),c(1,3,(4:13)[!((4:13) %in% as.numeric(country.re[country,]))]))
Product.exp.sha[,which(country == Country)] <- Prod.s(Product.exp.sha[,which(country == Country)],c(2,3,as.numeric(country.ex[country,])),c(1,(4:13)[!((4:13) %in% as.numeric(country.ex[country,]))]))
Product.rev.share = Product.rev.sha[,which(country == Country)]
Product.exp.share = Product.exp.sha[,which(country == Country)]
for (product in Product$ID) {
rev.product <- rev.country * Product.rev.share[which(product == Product$ID)]
exp.product <- expense.country * Product.exp.share[which(product == Product$ID)]
for (qrt in c("Qrt 1", "Qrt 2", "Qrt 3", "Qrt 4")) {
qrt.share = sample(22:28,4) * rnorm(4,1,0.1)
qrt.share <- qrt.share/sum(qrt.share)
rev.prod.qrt <- rev.product * qrt.share[which(qrt == c("Qrt 1", "Qrt 2", "Qrt 3", "Qrt 4"))]
qrt.share = sample(22:28,4) * rnorm(4,1,0.1)
qrt.share <- qrt.share/sum(qrt.share)
exp.prod.qrt <- exp.product * qrt.share[which(qrt == c("Qrt 1", "Qrt 2", "Qrt 3", "Qrt 4"))]
Region = Country.region[which(Country == country)]
data.country.prod <- data.frame(Country = country, Region = Region,
Year = year, Qrt = qrt, Product = product, Revenue = round(rev.prod.qrt,2), Expense = round(exp.prod.qrt,2),Sales.From.Online.Store = round(OnlineFraction(Region,year),2))
Sale.data <- rbind(Sale.data, data.country.prod)
}
}
}
Sales <- rbind(Sales,Sale.data)
}
Online <- NULL
for(year in Data$FY)
{
Online = c(Online, sum(Sales[which(Sales$Year == year),6] * Sales[which(Sales$Year == year),8]))
}
Data$B.M.Store = Data$B.M.Store + Data$Online - Online
Data$Online = Online
write.csv(Data,"Levis' Data.csv")
### General Stats, Debt, Expense
GStats <- Data[,c(2,6,7,8,9,10,11,12,20,21,26,27)]
GStats
write.csv(GStats,"General Stats.csv")
write.csv(Sales, "Sales Data.csv")
Product <- Product[sample(1:NROW(Product)),]
row.names(Product) <- 1:13
Product
write.csv(Product,"Product.csv")
write.csv(Ad,"Advertisement and Promotion.csv")
y2006 <- Sales[which(Sales$Year == 2006),]
sum(y2006$Revenue)
